# –ê–Ω–∞–ª–∏–∑ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –ø–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

**–î–∞—Ç–∞ –∞–Ω–∞–ª–∏–∑–∞:** 2025-12-11  
**–°–∏—Å—Ç–µ–º–∞:** 4 —è–¥—Ä–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞, 8 –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö —è–¥–µ—Ä

---

## üìä –¢–µ–∫—É—â–∞—è —Å–∏—Ç—É–∞—Ü–∏—è: —á—Ç–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ

### ‚úÖ –ß—Ç–æ –°–ï–ô–ß–ê–° —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ:

1. **–ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤ –≤–Ω—É—Ç—Ä–∏ –æ–¥–Ω–æ–π –≥—Ä—É–ø–ø—ã** (ThreadPoolExecutor, max_workers=4)
   - **–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** —Å—Ç—Ä–æ–∫–∏ 971-1026 –≤ `load_all_files()`
   - **–ß—Ç–æ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ:** —Ñ–∞–π–ª—ã –æ–¥–Ω–æ–π –≥—Ä—É–ø–ø—ã (OD, RA –∏–ª–∏ PS) –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
   - **–ü—Ä–∏–º–µ—Ä:** –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ OD –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è M-1_OD.xlsx, M-2_OD.xlsx, ..., M-12_OD.xlsx (–¥–æ 4 –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ)
   - **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:** `ThreadPoolExecutor(max_workers=4)`

### ‚ùå –ß—Ç–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –ü–û–°–õ–ï–î–û–í–ê–¢–ï–õ–¨–ù–û:

1. **–ó–∞–≥—Ä—É–∑–∫–∞ –≥—Ä—É–ø–ø:** OD ‚Üí RA ‚Üí PS (—Å—Ç—Ä–æ–∫–∞ 937)
   - –ì—Ä—É–ø–ø—ã –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –ø–æ –æ—á–µ—Ä–µ–¥–∏
   - –í–Ω—É—Ç—Ä–∏ –∫–∞–∂–¥–æ–π –≥—Ä—É–ø–ø—ã —Ñ–∞–π–ª—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ

2. **`collect_unique_tab_numbers()`** (—Å—Ç—Ä–æ–∫–∞ 1630)
   - –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≥—Ä—É–ø–ø: OD ‚Üí RA ‚Üí PS
   - –í–Ω—É—Ç—Ä–∏ –∫–∞–∂–¥–æ–π –≥—Ä—É–ø–ø—ã —Ñ–∞–π–ª—ã –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ

3. **`prepare_raw_data()`** (—Å—Ç—Ä–æ–∫–∞ 1955)
   - –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≥—Ä—É–ø–ø: OD ‚Üí RA ‚Üí PS
   - –í–Ω—É—Ç—Ä–∏ –∫–∞–∂–¥–æ–π –≥—Ä—É–ø–ø—ã —Ñ–∞–π–ª—ã –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ (—Å—Ç—Ä–æ–∫–∏ 1985-2032)

4. **`prepare_summary_data()`** (—Å—Ç—Ä–æ–∫–∞ 2099)
   - –°–æ–∑–¥–∞–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–æ–≤: –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ñ–∞–π–ª–∞ (—Å—Ç—Ä–æ–∫–∏ 2157-2181)
   - –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–∞–±–µ–ª—å–Ω—ã—Ö –Ω–æ–º–µ—Ä–æ–≤: –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–π —Ü–∏–∫–ª (—Å—Ç—Ä–æ–∫–∞ 2191)

5. **`prepare_calculated_data()`** (—Å—Ç—Ä–æ–∫–∞ 2348)
   - –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≥—Ä—É–ø–ø –∏ –º–µ—Å—è—Ü–µ–≤ (—Å—Ç—Ä–æ–∫–∏ 2493-2600)

6. **`_normalize_indicators()`** (—Å—Ç—Ä–æ–∫–∞ 2661)
   - –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ –≥—Ä—É–ø–ø–∞–º: OD ‚Üí RA ‚Üí PS (—Å—Ç—Ä–æ–∫–∞ 2738)

7. **`_calculate_best_month_variant3()`** (—Å—Ç—Ä–æ–∫–∞ 2865)
   - –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–π —Ä–∞—Å—á–µ—Ç Score –ø–æ –º–µ—Å—è—Ü–∞–º (—Å—Ç—Ä–æ–∫–∞ 2944)
   - –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–π —Ä–∞—Å—á–µ—Ç —Ä–∞–Ω–≥–æ–≤ –ø–æ –º–µ—Å—è—Ü–∞–º (—Å—Ç—Ä–æ–∫–∞ 2977)

8. **–§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ Excel** (—Å—Ç—Ä–æ–∫–∞ 3220+)
   - –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–∏—Å—Ç–æ–≤

---

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ RAW –¥–∞–Ω–Ω—ã—Ö

**–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ:** RAW –¥–∞–Ω–Ω—ã–µ –±–µ—Ä—É—Ç—Å—è –∏–∑ `self.processed_files`, –∫–æ—Ç–æ—Ä—ã–π –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è `drop_rules` –∏ `in_rules` –≤ –º–µ—Ç–æ–¥–µ `_load_file()` (—Å—Ç—Ä–æ–∫–∏ 1258-1264).

**–í—ã–≤–æ–¥:** ‚úÖ –î–∞–Ω–Ω—ã–µ –≤ RAW —É–∂–µ –æ—á–∏—â–µ–Ω–Ω—ã–µ - —ç—Ç–æ **–ö–û–†–†–ï–ö–¢–ù–û**.

---

## üöÄ –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –ø–æ —Ä–∞—Å–ø–∞—Ä–∞–ª–ª–µ–ª–∏–≤–∞–Ω–∏—é

### 1. –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –≤—Å–µ—Ö –≥—Ä—É–ø–ø (üî• –í–´–°–û–ö–ò–ô –ü–†–ò–û–†–ò–¢–ï–¢)

**–¢–µ–∫—É—â–∞—è —Å–∏—Ç—É–∞—Ü–∏—è:**
- –ì—Ä—É–ø–ø—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ: OD ‚Üí RA ‚Üí PS
- –í–Ω—É—Ç—Ä–∏ –≥—Ä—É–ø–ø—ã —Ñ–∞–π–ª—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ (4 –ø–æ—Ç–æ–∫–∞)

**–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ:**
- –ó–∞–≥—Ä—É–∂–∞—Ç—å –≤—Å–µ –≥—Ä—É–ø–ø—ã –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ: OD, RA, PS –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `ThreadPoolExecutor` —Å `max_workers=8` (–ø–æ —á–∏—Å–ª—É –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö —è–¥–µ—Ä)
- **–û–∂–∏–¥–∞–µ–º–æ–µ —É—Å–∫–æ—Ä–µ–Ω–∏–µ:** 2-3x (—Å ~15-20 —Å–µ–∫ –¥–æ ~5-7 —Å–µ–∫)

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```python
# –í–º–µ—Å—Ç–æ:
for group in self.groups:
    # –∑–∞–≥—Ä—É–∑–∫–∞ –≥—Ä—É–ø–ø—ã

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:
with ThreadPoolExecutor(max_workers=8) as executor:
    futures = {
        executor.submit(self._load_group_files, group): group 
        for group in self.groups
    }
    for future in as_completed(futures):
        group = futures[future]
        # –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
```

---

### 2. –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–æ–≤ –≤ `prepare_summary_data()` (üî• –í–´–°–û–ö–ò–ô –ü–†–ò–û–†–ò–¢–ï–¢)

**–¢–µ–∫—É—â–∞—è —Å–∏—Ç—É–∞—Ü–∏—è:**
- –ò–Ω–¥–µ–∫—Å—ã —Å–æ–∑–¥–∞—é—Ç—Å—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ñ–∞–π–ª–∞ (36 —Ñ–∞–π–ª–æ–≤)
- –û–ø–µ—Ä–∞—Ü–∏—è: `groupby()` + `sum()` –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ñ–∞–π–ª–∞ (—Å—Ç—Ä–æ–∫–∏ 2157-2181)

**–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ:**
- –°–æ–∑–¥–∞–≤–∞—Ç—å –∏–Ω–¥–µ–∫—Å—ã –¥–ª—è –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `ThreadPoolExecutor` —Å `max_workers=8`
- **–û–∂–∏–¥–∞–µ–º–æ–µ —É—Å–∫–æ—Ä–µ–Ω–∏–µ:** 3-4x (—Å ~2-3 —Å–µ–∫ –¥–æ ~0.5-1 —Å–µ–∫)

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```python
# –í–º–µ—Å—Ç–æ:
for group, file_name, full_name in all_files:
    # —Å–æ–∑–¥–∞–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–∞

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:
with ThreadPoolExecutor(max_workers=8) as executor:
    future_to_file = {
        executor.submit(self._create_file_index, group, file_name, full_name, df): (group, file_name, full_name)
        for group, file_name, full_name in all_files
        if group in self.processed_files and file_name in self.processed_files[group]
    }
    for future in as_completed(future_to_file):
        group, file_name, full_name = future_to_file[future]
        file_indexes[full_name] = future.result()
```

---

### 3. –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∞–π–ª–æ–≤ –≤ `prepare_raw_data()` (‚ö° –°–†–ï–î–ù–ò–ô –ü–†–ò–û–†–ò–¢–ï–¢)

**–¢–µ–∫—É—â–∞—è —Å–∏—Ç—É–∞—Ü–∏—è:**
- –§–∞–π–ª—ã –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –≤ —Ü–∏–∫–ª–∞—Ö –ø–æ –≥—Ä—É–ø–ø–∞–º (—Å—Ç—Ä–æ–∫–∏ 1985-2032)
- –û–ø–µ—Ä–∞—Ü–∏—è: `groupby()` –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ñ–∞–π–ª–∞

**–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ:**
- –û–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –≤—Å–µ —Ñ–∞–π–ª—ã –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ (–Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –≥—Ä—É–ø–ø—ã)
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `ThreadPoolExecutor` —Å `max_workers=8`
- **–û–∂–∏–¥–∞–µ–º–æ–µ —É—Å–∫–æ—Ä–µ–Ω–∏–µ:** 3-4x

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```python
# –í–º–µ—Å—Ç–æ:
for group in self.groups:
    for file_name, df in self.processed_files[group].items():
        # –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∞–π–ª–∞

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:
with ThreadPoolExecutor(max_workers=8) as executor:
    futures = []
    for group in self.groups:
        for file_name, df in self.processed_files[group].items():
            future = executor.submit(self._process_file_for_raw, group, file_name, df, defaults)
            futures.append(future)
    
    raw_data_list = [future.result() for future in as_completed(futures)]
```

---

### 4. –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ –≥—Ä—É–ø–ø–∞–º –≤ `_normalize_indicators()` (‚ö° –°–†–ï–î–ù–ò–ô –ü–†–ò–û–†–ò–¢–ï–¢)

**–¢–µ–∫—É—â–∞—è —Å–∏—Ç—É–∞—Ü–∏—è:**
- –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è OD, RA, PS (—Å—Ç—Ä–æ–∫–∞ 2738)
- –û–ø–µ—Ä–∞—Ü–∏–∏ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã

**–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ:**
- –ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞—Ç—å OD, RA, PS –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `ThreadPoolExecutor` —Å `max_workers=3`
- **–û–∂–∏–¥–∞–µ–º–æ–µ —É—Å–∫–æ—Ä–µ–Ω–∏–µ:** 2-3x

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```python
# –í–º–µ—Å—Ç–æ:
for group_name, direction in [("OD", od_direction), ("RA", ra_direction), ("PS", ps_direction)]:
    # –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –≥—Ä—É–ø–ø—ã

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:
with ThreadPoolExecutor(max_workers=3) as executor:
    futures = {
        executor.submit(self._normalize_group, group_name, direction, month_data, calculated_df): group_name
        for group_name, direction in [("OD", od_direction), ("RA", ra_direction), ("PS", ps_direction)]
    }
    for future in as_completed(futures):
        group_name = futures[future]
        normalized_cols = future.result()
        # –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–æ–ª–æ–Ω–æ–∫ –≤ normalized_df
```

---

### 5. –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–π —Ä–∞—Å—á–µ—Ç Score –ø–æ –º–µ—Å—è—Ü–∞–º –≤ `_calculate_best_month_variant3()` (üìù –ù–ò–ó–ö–ò–ô –ü–†–ò–û–†–ò–¢–ï–¢)

**–¢–µ–∫—É—â–∞—è —Å–∏—Ç—É–∞—Ü–∏—è:**
- Score —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –º–µ—Å—è—Ü–∞ (M-1, M-2, ..., M-12) (—Å—Ç—Ä–æ–∫–∞ 2944)
- –û–ø–µ—Ä–∞—Ü–∏–∏ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã

**–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ:**
- –†–∞—Å—Å—á–∏—Ç—ã–≤–∞—Ç—å Score –¥–ª—è –≤—Å–µ—Ö –º–µ—Å—è—Ü–µ–≤ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `ThreadPoolExecutor` —Å `max_workers=8`
- **–û–∂–∏–¥–∞–µ–º–æ–µ —É—Å–∫–æ—Ä–µ–Ω–∏–µ:** 2-3x (–µ—Å–ª–∏ –º–µ—Å—è—Ü–µ–≤ –º–Ω–æ–≥–æ)

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```python
# –í–º–µ—Å—Ç–æ:
for month in sorted(month_data.keys()):
    # —Ä–∞—Å—á–µ—Ç Score –¥–ª—è –º–µ—Å—è—Ü–∞

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:
with ThreadPoolExecutor(max_workers=8) as executor:
    futures = {
        executor.submit(self._calculate_score_for_month, month, normalized_df, weight_od, weight_ra, weight_ps): month
        for month in sorted(month_data.keys())
    }
    for future in as_completed(futures):
        month = futures[future]
        score_col_name, score = future.result()
        places_df[score_col_name] = score
```

---

### 6. –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–∏—Å—Ç–æ–≤ Excel (üìù –ù–ò–ó–ö–ò–ô –ü–†–ò–û–†–ò–¢–ï–¢, —Ç—Ä–µ–±—É–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏)

**–¢–µ–∫—É—â–∞—è —Å–∏—Ç—É–∞—Ü–∏—è:**
- –õ–∏—Å—Ç—ã —Ñ–æ—Ä–º–∞—Ç–∏—Ä—É—é—Ç—Å—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ (RAW ‚Üí –ò—Å—Ö–æ–¥–Ω–∏–∫ ‚Üí –†–∞—Å—á–µ—Ç ‚Üí ...)

**–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ:**
- –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–µ –ª–∏—Å—Ç—ã –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ
- **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ:** openpyxl –º–æ–∂–µ—Ç –∏–º–µ—Ç—å –ø—Ä–æ–±–ª–µ–º—ã —Å –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–π –∑–∞–ø–∏—Å—å—é –≤ –æ–¥–∏–Ω —Ñ–∞–π–ª
- **–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞:** —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞—Ç—å –ª–∏—Å—Ç—ã –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ, –∑–∞—Ç–µ–º –æ–±—ä–µ–¥–∏–Ω—è—Ç—å

---

## üìã –ò—Ç–æ–≥–æ–≤—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞–º

### üî• –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –≤–Ω–µ–¥—Ä–∏—Ç—å):

1. **–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –≤—Å–µ—Ö –≥—Ä—É–ø–ø** ‚Äî —É—Å–∫–æ—Ä–µ–Ω–∏–µ 2-3x
2. **–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–æ–≤ –≤ `prepare_summary_data()`** ‚Äî —É—Å–∫–æ—Ä–µ–Ω–∏–µ 3-4x

### ‚ö° –°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (–º–æ–∂–Ω–æ –≤–Ω–µ–¥—Ä–∏—Ç—å):

3. **–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∞–π–ª–æ–≤ –≤ `prepare_raw_data()`** ‚Äî —É—Å–∫–æ—Ä–µ–Ω–∏–µ 3-4x
4. **–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ –≥—Ä—É–ø–ø–∞–º** ‚Äî —É—Å–∫–æ—Ä–µ–Ω–∏–µ 2-3x

### üìù –ù–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):

5. **–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–π —Ä–∞—Å—á–µ—Ç Score –ø–æ –º–µ—Å—è—Ü–∞–º** ‚Äî —É—Å–∫–æ—Ä–µ–Ω–∏–µ 2-3x
6. **–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ Excel** ‚Äî —Ç—Ä–µ–±—É–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏

---

## üìà –û–∂–∏–¥–∞–µ–º—ã–π –æ–±—â–∏–π —ç—Ñ—Ñ–µ–∫—Ç

–ü—Ä–∏ –≤–Ω–µ–¥—Ä–µ–Ω–∏–∏ –≤—Å–µ—Ö –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π **–≤—ã—Å–æ–∫–æ–≥–æ –∏ —Å—Ä–µ–¥–Ω–µ–≥–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞**:
- **–¢–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è:** ~46 —Å–µ–∫—É–Ω–¥ (–ø—Ä–∏–º–µ—Ä–Ω–æ)
- **–û–∂–∏–¥–∞–µ–º–æ–µ –≤—Ä–µ–º—è:** ~10-15 —Å–µ–∫—É–Ω–¥
- **–û–±—â–µ–µ —É—Å–∫–æ—Ä–µ–Ω–∏–µ:** **3-4x**

---

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∑–∞–º–µ—á–∞–Ω–∏—è

### 1. ThreadPoolExecutor vs ProcessPoolExecutor:
- **ThreadPoolExecutor** –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è I/O –æ–ø–µ—Ä–∞—Ü–∏–π (–∑–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤)
- –î–ª—è CPU-–∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π (groupby, —Ä–∞—Å—á–µ—Ç—ã) –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **ProcessPoolExecutor**
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** ThreadPoolExecutor –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏, ProcessPoolExecutor –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏–π

### 2. –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö:
- –ü—Ä–∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–µ –Ω—É–∂–Ω–æ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥–æ—Å—Ç—É–ø –∫ –æ–±—â–∏–º —Å—Ç—Ä—É–∫—Ç—É—Ä–∞–º –¥–∞–Ω–Ω—ã—Ö
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `threading.Lock` –∏–ª–∏ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏–∑ –ø–æ—Ç–æ–∫–æ–≤ –∏ –æ–±—ä–µ–¥–∏–Ω—è—Ç—å –∏—Ö

### 3. –û–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Ç–æ–∫–æ–≤:
- –î–ª—è I/O: –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–æ–ª—å—à–µ –ø–æ—Ç–æ–∫–æ–≤ (8-12)
- –î–ª—è CPU: –ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —è–¥–µ—Ä (4-8)
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** `max_workers=8` –¥–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ –æ–ø–µ—Ä–∞—Ü–∏–π

### 4. –£–≤–µ–ª–∏—á–µ–Ω–∏–µ MAX_WORKERS:
- **–¢–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ:** `MAX_WORKERS = 4`
- **–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è:** `MAX_WORKERS = 8` (–ø–æ —á–∏—Å–ª—É –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö —è–¥–µ—Ä)

---

## üìù –†–µ–∑—é–º–µ

**–°–µ–π—á–∞—Å –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ —Ñ–∞–π–ª—ã –≤–Ω—É—Ç—Ä–∏ –æ–¥–Ω–æ–π –≥—Ä—É–ø–ø—ã (–¥–æ 4 –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ).** –ì—Ä—É–ø–ø—ã –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ, —á—Ç–æ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤.

**–û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —É—Å–∫–æ—Ä–µ–Ω–∏—è:**
1. –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –≤—Å–µ—Ö –≥—Ä—É–ø–ø (2-3x)
2. –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–æ–≤ (3-4x)
3. –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∞–π–ª–æ–≤ –≤ RAW (3-4x)
4. –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ –≥—Ä—É–ø–ø–∞–º (2-3x)

**–û–±—â–∏–π –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª —É—Å–∫–æ—Ä–µ–Ω–∏—è:** **3-4x** –ø—Ä–∏ –≤–Ω–µ–¥—Ä–µ–Ω–∏–∏ –≤—Å–µ—Ö –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π –≤—ã—Å–æ–∫–æ–≥–æ –∏ —Å—Ä–µ–¥–Ω–µ–≥–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞.

**RAW –¥–∞–Ω–Ω—ã–µ —É–∂–µ –æ—á–∏—â–µ–Ω–Ω—ã–µ** ‚úÖ - —ç—Ç–æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.
